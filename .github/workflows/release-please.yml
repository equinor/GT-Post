on:
    push:
      branches:
        - main
  
name: release-please
  
jobs:
    release-please:
      runs-on: ubuntu-latest
      outputs:
        release_created: ${{ steps.release.outputs.release_created }}
        tag_name: ${{ steps.release.outputs.tag_name }}
      steps:
        - name: Generate a token
          id: generate-token
          uses: actions/create-github-app-token@v1
          with:
            app-id: ${{ vars.PEPM_CI_APP_ID }}
            private-key: ${{ secrets.PEPM_CI_APP_SECRET }}

        - name: Release Please
          uses: googleapis/release-please-action@v4
          id: release
          with:
            release-type: simple
            config-file: release-please-config.json
            token: ${{ steps.generate-token.outputs.token }}